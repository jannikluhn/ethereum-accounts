{
  "$schema": "http://json-schema.org/schema#",
  "id": "https://github.com/jannikluhn/ethereum-accounts",
  "type": "object",

  "required": [
    "version",
    "crypto"
  ],

  "properties": {
    "version": {
      "type": "integer",
      "minimum": 3,
      "maximum": 3
    },

    "address": {
      "type": "string",
      "pattern": "^(0x)?([0-f]|[A-F]){40}$"
    },

    "meta": {
      "type": "string"
    },

    "name": {
      "type": "string"
    },

    "crypto": {
      "type": "object",

      "required": [
        "cipher",
        "cipherparams",
        "ciphertext",
        "kdf",
        "kdfparams",
        "mac"
      ],

      "additionalProperties": false,

      "properties": {
        "cipher": {
          "type": "string"
        },
        "cipherparams": {
          "type": "object"
        },
        "ciphertext": {
          "type": "string"
        },
        "kdf": {
          "type": "string"
        },
        "kdfparams": {
          "type": "object"
        },
        "mac": {
          "type": "string",
          "pattern": "[0-f]{64}"
        }
      },

      "allOf": [
        {
          "oneOf": [
            {
              "properties": {
                "cipher": {
                  "type": "string",
                  "enum": ["aes-128-ctr"]
                },
                "cipherparams": {
                  "$ref": "#/definitions/aes128ctrParams"
                },
                "cipher": {
                  "$ref": "#/definitions/aes128ctrCipher"
                }
              }
            }
          ]
        },
        {
          "oneOf": [
            {
              "properties": {
                "kdf": {
                  "type": "string",
                  "enum": ["pbkdf2"]
                },
                "kdfparams": {
                  "$ref": "#/definitions/pbkdf2Params"
                }
              }
            },
            {
              "properties": {
                "kdf": {
                  "type": "string",
                  "enum": ["scrypt"]
                },
                "kdfparams": {
                  "$ref": "#/definitions/scryptParams"
                }
              }
            }
          ]
        },
      ]
    }
  },


  "definitions": {
    "aes128ctrParams": {
      "type": "object",
      "requiredProperties": ["iv"],
      "additionalProperties": false,
      "properties": {
        "iv": {
          "type": "string",
          "pattern": "[0-f]{32}"
        }
      }
    },

    "aes128ctrCipher": {
      "type": "string",
      "pattern": "[0-f]{64}"
    },

    "pbkdf2Params": {
      "type": "object",
      "requiredParams": [
        "c",
        "dklen",
        "prf",
        "salt"
      ],
      "additionalProperties": false,
      "properties": {
        "c": {
          "type": "integer",
          "minimum": 1
        },
        "dklen": {
          "type": "integer",
          "minimum": 1
        },
        "prf": {
          "type": "string",
          "enum": ["hmac-sha256"]
        },
        "salt": {
          "type": "string",
          "pattern": "[0-f]{64}"
        }
      }
    },

    "scryptParams": {
      "type": "object",
      "requiredParams": [
        "r",
        "p",
        "n",
        "dklen",
        "salt",
      ],
      "additionalProperties": false,
      "properties": {
        "r": {
          "type": "integer",
          "minimum": 1
        },
        "p": {
          "type": "integer",
          "minimum": 1
        },
        "n": {
          "type": "integer",
          "minimum": 1
        },
        "dklen": {
          "type": "integer",
          "minimum": 1
        },
        "salt": {
          "type": "string",
          "pattern": "[0-f]{64}"
        }
      }
    }
  }
}
